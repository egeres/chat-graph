<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chats</title>
    <link rel="stylesheet" href="style_b.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/split.js/1.5.11/split.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/@shopify/draggable@1.0.0-beta.8/lib/draggable.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.12.0/d3.js"></script>
    <!-- <script src="https://unpkg.com/eva-icons"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script> -->

    <!-- <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js?ver=1.3.2'></script>
    <script type='text/javascript' src='/js/jquery.mousewheel.min.js'></script> -->
</head>
<body>
  
    <div class="bar_control">

        Sort by:
        <div class="radio-toolbar">
            <input onclick='window.ui_order_by_alphabetical()' type="radio" id="radio1" name="radios" checked><label for="radio1">Alphabetical</label>
            <input onclick='window.ui_order_by_most()'         type="radio" id="radio2" name="radios" >|<label for="radio2">Most</label>
            <input onclick='window.ui_order_by_lastest()'      type="radio" id="radio3" name="radios" >|<label for="radio3">Lastest</label>
            <input onclick='window.ui_order_by_oldest()'       type="radio" id="radio4" name="radios" >|<label for="radio4">Oldest</label>
        </div>
        <a style="margin-left: 5px;" data-eva="arrow-downward-outline" data-eva-fill="#f58c4f" data-eva-width="24"></a>

        <span style="width: 50px;"></span>
        Mode:
        <div class="radio-toolbar">
            <input type="radio" id="radio10" name="radiosT" checked><label for="radio10">D</label>
            <input type="radio" id="radio20" name="radiosT" >|<label for="radio20">W</label>
            <input type="radio" id="radio30" name="radiosT" >|<label for="radio30">M</label>|
            <!-- <input type="radio" id="radio4" name="radios" >|<label for="radio4">Oldest</label> -->
        </div>

        <a style="margin-right: 0px;" data-eva="arrow-left-outline" data-eva-width="24" onclick="window.ui_property_days_width_decrease()"></a>
        <a id="value_days_width">4</a>
        <a style="margin-left: 0px;" data-eva="arrow-right-outline" data-eva-width="24"onclick="window.ui_property_days_width_increase()"></a>



        <span style="width: 50px;"></span>
        Color:
        <select style="margin-left: 5px;">
            <option value="volvo">interpolateYlOrRd</option>
            <option value="saab">interpolateGreys</option>
            <option value="opel">interpolateInferno</option>
        </select>
        <a style="margin-left: 5px;" data-eva="arrow-downward-outline" data-eva-fill="#f58c4f" data-eva-width="24"></a>


        <!-- <span style="width: 50px;"></span>
        <a style="margin-left: 10px;" data-eva="alert-circle-outline"   data-eva-fill="#f5544f" data-eva-width="24"></a>
        0
        <a style="margin-left: 10px;" data-eva="alert-triangle-outline" data-eva-fill="#f5f24f" data-eva-width="24"></a>
        0 -->

        <span style="width: 50px;"></span>
        <a id="btn-visible" data-eva="eye-outline" onclick="window.ui_property_toggle_hidden()"></a>

        <!-- <a style="left_" data-eva="flip-2-outline" data-eva-fill="#f5f24f" onclick="window.update_chats()"></a> -->
        <!-- <a style="left_" data-eva="flip-2-outline" data-eva-fill="#f5f24f" onclick="window.update_chats()"></a> -->
        <!-- <a style="float:right;position: relative;" data-eva="flip-2-outline" data-eva-fill="#f5f24f" onclick="window.update_chats()"></a> -->
        <!-- <a style="right:-10px;position: absolute;" data-eva="flip-2-outline" data-eva-fill="#f5f24f" onclick="window.update_chats()"></a> -->
        <span style="width: 50px;"></span>
        <a data-eva="flip-2-outline" data-eva-fill="#f5f24f" onclick="window.update_chats()"></a>

        <!-- flip-2-outline -->

    </div>

    <div class="container_global">
            <!-- keypad-outline -->

        <div id="panel_names">
            <!-- <div class="row_name"><div class="spann"></div>AAA</div>
            <div class="row_name"><div class="spann"></div>BBB</div>
            <div class="row_name"><div class="spann"></div>CCC</div>
            <div class="row_name"><div class="spann"></div>DDD</div> -->

            <div class="row_name"><i data-eva='more-vertical-outline' class="spann" data-eva-width="24"></i>AAA</div>
            <div class="row_name"><i data-eva='more-vertical-outline' class="spann" data-eva-width="24"></i>BBB</div>
            <div class="row_name"><i data-eva='more-vertical-outline' class="spann" data-eva-width="24"></i>CCC</div>
            <div class="row_name"><i data-eva='more-vertical-outline' class="spann" data-eva-width="24"></i>DDD</div>

        </div>

        <div id="panel_histories">
            <div class="row_graph"></div>
            <div class="row_graph"></div>
            <div class="row_graph"></div>
            <div class="row_graph"></div>
            <!-- <div class="row_graph" style="background-color: orange;">a</div>
            <div class="row_graph" style="background-color: violet;">vv h sd sd sd ds s ds dsdddd jahsjhasjhdbajsdbjhasdgbjhagjsgd fkjs hdgfkjsdafkjsadgkjhags dfkjsadfbhb hjhbjdbj jhbsdjb jsbjbsj h bsjbsjb hjv</div>
            <div class="row_graph" style="background-color: khaki;">c</div> -->

            <div class="row_timeline"></div>
        </div>

    </div>

    <div style="height: 100px; width: 100px;"></div>

</body>

<script>

    // function ui_property_days_width_increase() {
    //     console.log("Incresaing...");
        
    //     if (days_width === 1 ) { days_width = 2 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 2 ) { days_width = 4 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 4 ) { days_width = 8 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 8 ) { days_width = 24; Cookies.set('days_width', days_width); }
    //     if (days_width === 24) { days_width = 30; Cookies.set('days_width', days_width); }
    // }

    // function ui_property_days_width_decrease() {
    //     console.log("Decresaing...");

    //     if (days_width === 2 ) { days_width = 1 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 4 ) { days_width = 2 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 8 ) { days_width = 4 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 24) { days_width = 8 ; Cookies.set('days_width', days_width); }
    //     if (days_width === 30) { days_width = 24; Cookies.set('days_width', days_width); }
    // }

    // function assign_indexes() {
    //     console.log("Assigning indexes");
        
    //     var array = document.getElementById("panel_names").children;
    //     for (let index = 0; index < array.length; index++) {
    //         const element = array[index];
    //         // console.log(element);
    //         element.classList.add("index_" + index.toString());
    //     }

    //     var array = document.getElementById("panel_histories").children;
    //     for (let index = 0; index < array.length; index++) {
    //         const element = array[index];
    //         // console.log(element);
    //         element.classList.add("index_" + index.toString());
    //     }

    // }

    // assign_indexes()

    function reorder_right_list() {
        // console.log("ordering...");

        var list_refrence  = document.getElementById('panel_names');
        var list_histories = document.getElementById('panel_histories');
        
        // Generamos la lista de orders
        var newOrder = [];
        for (let index = 0; index < list_refrence.children.length; index++) {
            const element = list_refrence.children[index];
            // console.log(element.classList[1]);
            newOrder.push( parseInt(element.classList[1].split("_")[1]) )
        }
        // console.log(newOrder);
        var reordered_elements = [];
        for(let i=0;i<newOrder.length;i++){
            // for(let j=0;j<newOrder.length;j++){
            //     if(i==newOrder[j]){ 
            //         list_histories.appendChild(list_histories.children[j]);
            //     break;
            //     }
            // }

            for (let j = 0; j < list_histories.children.length; j++) {
                const element_j = list_histories.children[j];
                // console.log(element_j);
                
                if(element_j.classList.contains("index_" + newOrder[i].toString())   ){ 
                    
                    list_histories.appendChild(list_histories.children[   j   ]);
                    reordered_elements.push(list_histories.children[   j   ])
                }
                
            }
        }

        // Reordenar las cosas que se suelen quedar fuera
        for (let index = 0; index < list_histories.children.length; index++) {
            const element = list_histories.children[index];

            // if (! reordered_elements.includes(element)) {
            //     console.log(list_histories.children[ index ]);
            //     list_histories.appendChild(list_histories.children[ index ]);
            // }

            if (element.classList.contains("row_timeline")) {
                list_histories.appendChild(element);
            }
        }


    }

    Split(['#panel_names', '#panel_histories'], {
        sizes: [20, 80],
        minSize: [10, 100],
        gutterSize: 3,
    });

    var listWithHandle = document.getElementById("panel_names");

    Sortable.create(listWithHandle, {
        // sort: false,
        handle: '.spann',
        animation: 200,
        onStart: function () {
            console.log("asdads");
            
        },
        onEnd: function () { reorder_right_list(); }
    });


    function draw_test_graph() {
        

        var square_x      = 4;
        var square_y      = 60;
        var square_margin = 0;
        var scall         = d3.scaleLinear().domain([0,15]).range([1, 0]);

        function getBaseLog(x, y) {
            return Math.log(y) / Math.log(x);
        }

        var svg = d3.select(
            document.getElementById("panel_histories").firstElementChild
        ).append("svg");

        // width  = chartDiv.offsetWidth;
        // height = chartDiv.offsetHeight;
        width  = 300;
        height = 45;
        svg.attr("width", width).attr("height", height);
        var g = svg.append("g").attr("transform", "translate(0, 0)");

        // g.selectAll("foo").data(single_chat_history.chat_messages_1).enter().append("rect")
        g.selectAll("foo").data([0,80,0,100, 1, 1, 3, 4, 6, 8, 0, 0 ,0 , 0,5,6,4,3,5,7,78,4,5, 200, 300, 500, 900, 10]).enter().append("rect")
            .attr("x", function(d, i) { return width - (i + 1) * (square_x+square_margin); } )
            // .attr("y", function(d, i) { return separation + i * (square_size+separation) + index *( margin_streams + 12 * (square_size+separation)); })
            // .attr("y", function(d, i) { return index *( square_1_y+margin_1_y); })
            .attr("y", function(d, i) { return 0; })
            .attr("width" , square_x)
            .attr("height", square_y)
            // .attr("fill", function(d, i) {  return d3.interpolateYlOrRd( 1 - getBaseLog(500, d) )} ); // logaritmic scale
            .attr("fill", function(d, i) {  return d3.interpolateYlOrRd(scall(d))} );
    
    }

    // draw_test_graph();

    function draw_timeline(params) {

        var svg = d3.select(
            document.getElementById("panel_histories").lastElementChild
        ).append("svg");
        width  = 1500;
        height = 45;
        
        svg.attr("width", width).attr("height", height);
        var g = svg.append("g").attr("transform", "translate(0, 0)");
        g.selectAll("foo").data([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]).enter().append("rect")
            .attr("x", function(d, i) { return i * 4 * 31; } )
            .attr("y", function(d, i) { return 0; })
            .attr("width" , 1)
            .attr("height", function(d) {return (d%12===0) ? 30 : 10; })
            .attr("fill", function(d, i) {  return '#fff'} );

    }

    // draw_timeline()

    (function() {
        function scrollHorizontally(e) {
            e = window.event || e;
            var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));
            document.getElementById('panel_histories').scrollLeft -= (delta*40); // Multiplied by 40
            e.preventDefault();
        }
        if (document.getElementById('panel_histories').addEventListener) {
            // IE9, Chrome, Safari, Opera
            document.getElementById('panel_histories').addEventListener("mousewheel", scrollHorizontally, false);
            // Firefox
            document.getElementById('panel_histories').addEventListener("DOMMouseScroll", scrollHorizontally, false);
        } else {
            // IE 6/7/8
            document.getElementById('panel_histories').attachEvent("onmousewheel", scrollHorizontally);
        }
    })();


</script>
<script src="dist/bundle.js"></script>
</html>